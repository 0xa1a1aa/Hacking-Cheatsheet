Show all available records:
```bash
dig any <domain> @<nameserver-ip>
```

Enumerate all name servers for a domain:
```bash
dig ns <domain> @<nameserver-ip>
```

#### Chaos class queries

Get information via Chaos class (CH) queries from misconfigured servers:
https://dnsmonitor.com/resources/dns-check-kb/integrity-package/chaos-class-check/

Displays software name and its current version and in some cases the operating system:
```bash
dig CH TXT version.bind <nameserver-ip>
```

Displays configured hostname of the server:
```bash
dig CH TXT hostname.bind <nameserver-ip>
```
or:
```bash
dig CH TXT id.server <nameserver-ip>
```

---
# Zone Transfer

`Asynchronous Full Transfer Zone` (`AXFR`)  is a mechanism to replicate/synchronize DNS information between servers.

Through a misconfiguration it could be possible to query the entire zone file:
```bash
dig axfr <domain> @<nameserver-ip>
```
or:
```bash
dig axfr <subdomain.domain> @<nameserver-ip>
```

# Subdomain Brute Forcing

Subdomain names might not be known in advance, but we can brute-force them.

>[!Note]
>Try different wordlists!

Via bash for loop:
```bash
for sub in $(cat /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt);do dig $sub.<domain> @<nameserver-ip> | grep -v ';\|SOA' | sed -r '/^\s*$/d' | grep $sub | tee -a subdomains.txt;done
```

Via dnsenum:
```bash
dnsenum --dnsserver <nameserver-ip> --enum -p 0 -s 0 -o subdomains.txt -f /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt <domain>
```
Args:
`-p 0 -s 0`: disable Google scraping

---
# Enumerate domain names

nmap UDP scan enumerated a DNS service:
```bash
[...]
PORT   STATE         SERVICE VERSION
53/udp open          domain  ISC BIND 9.11.5-P4-5.1+deb10u5 (Debian Linux)
| dns-nsid: 
|_  bind.version: 9.11.5-P4-5.1+deb10u5-Debian
|_dns-recursion: Recursion appears to be enabled
[...]
```

Use *dnsrecon* to enumerate domain names on the remote DNS server via reverse DNS lookups:
```bash
dnsrecon -r 127.0.0.0/24 -n <dns-server-ip>
```
Args:
`-r`: Reverse lookup IP address range
`-n`: Name server