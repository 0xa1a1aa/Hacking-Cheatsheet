Connect to SMTP server:
```bash
telnet <ip> 25
```
followed by `EHLO`

Identify if the target server is an **open relay**:
```bash
sudo nmap -v -p 25 --script smtp-open-relay <ip>
```

# User enumeration

```bash
smtp-user-enum -h
smtp-user-enum -v -M VRFY -U users.txt -t <ip>
smtp-user-enum -v -M EXPN -u admin -t <ip>
smtp-user-enum -v -M RCPT -D example.com -U users.txt -t <ip>
```
If the server is of the slow type, experiment with increase of wait time and threads:
`-w <seconds>`: wait time for answer
`-m <threads>`: number of threads

(NOT-OSCP!) Metasploit:
```
msfconsole
use auxiliary/scanner/smtp/smtp_enum
```

# Login brute-forcing

Hydra with STARTTLS:
```bash
hydra -L <usernames.txt> -P <wordlist> -vV -s <port> -m TLS smtp://<ip>
```
